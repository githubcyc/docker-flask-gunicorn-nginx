
## 
> high availability

* 单机结构

* 集群结构 --> 负载均衡服务器(同一个业务，部署在多个服务器上)

* 分布式结构 --> 微服务架构

> 按照业务功能，拆分成一个个独立的子系统，在分布式结构中，每个子系统就被称为“服务”。
这些子系统能够独立运行在web容器中，它们之间通过`RPC`方式通信。

## architecture scheme

### 单中心数据集群

#### 单中心双机

* 一主一备的架构（主备式）--> `主从备份`
  * 备用机不提供线上服务
* 一主一从的架构（主从式）--> `读写分离`
  * 「从机」虽然也在随时随刻提供服务，但是它只提供「读」服务
* 互为主从的架构（主主式）--> `主从切换`
  * 互为主从的架构是指两台机器自己都是主机，并且也都是作为对方的从机。
  * 两台机器都提供完整的读写服务，因此无需切换，客户机在调用的时候随机挑选一台即可，当其中一台宕机了，另外一台还可以继续服务。
  * 采用 `互为主从架构` 有个复杂点就是，因为两台主机都接受写数据，那就需要将写的最新数据实时的同步给对方，需要将数据进行两台主机的双向复制。而双向复制不可避免的会在一定程度上带来`数据延迟`、极端情况下甚至有`数据丢失`等问题。在实际业务中，有些业务数据对`一致性要求`是非常高的，并不能接受数据的延迟、丢失，因此这类业务也不适合互为主从的模式，比如金融业务。但是我们互联网业务中大多数场景还是没有这么高要求的，所以这种模式对于一般场景还是用的蛮多。

* 主从双机自动切换：是指当主机出现故障后，从机能够自动检测发现。同时从机将自己迅速切换为主机，将原来的`主机立即下线服务`，或`转换为从机状态`。

> 要实现「`主从双机自动切换`」，有几个关键点需要考虑：主机与从机之间的状态如何判断？ 
> 必须有一个机制能监测两台机器的运行状态，以此来决定是否应该切换。
> 我们比较常用的状态传递方式有两种：

* 「双机互连模式」
* 「第三方中介模式」--> MongoDB的Replica Set

#### 单中心多机
> 数据集中(分散)模式的主要区别在于集群中的`完整业务数据`是全部集中在一台机器上，还是分散在多台机器上。

* 数据集中模式
> 这种模式与「一主一从式」（主从式）比较类似，完整的业务数据还是存储在一台主机的上，`主机承担读服务和写服务`，`从机只承担读服务`。但是从机有多台机器，从机实时的从主机同步数据。所以这种模式，也可以理解为「一主多从」式。
  * pros & cons
    * 由于数据集中模式的所有写操作都只到一台主机上，而读操作可以到N台从机上。因此这种模式比较适用于`业务数据量不大`、`读操作远远大于写操作、集群规模较小`的业务场景。
  * warnings 
    * 1.1，尽量将数据均衡的分散的各个机上，这样才能保证资源的均衡使用和性能的最佳。
    * 1.2，多台机器上的数据虽然不同，但是也需要`互相进行数据的备份`。
    * 1.3，要能`动态的增加和删除节点`，这样可以便于随时扩展，通常采用一致性HASH的方法。

* 数据分散模式
  
> 数据分散模式是指，完整的业务数据并非是全部存储在一台主机上的，而是由多台主机共同分担，分散存储。因此这种模式适用于`大数据量、集群规模较大`的场景。


### 多中心(地区-->机房)数据分区 （多中心多机）



## Refer　

* [数据分析与开发](https://mp.weixin.qq.com/s/0WWwBxuQlZtMAn9IqRePDw)